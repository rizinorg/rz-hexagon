// SPDX-FileCopyrightText: 2021 Rot127 <unisono@quyllur.org>
// SPDX-License-Identifier: LGPL-3.0-only

// LLVM commit: 96e220e6886868d6663d966ecc396befffc355e7
// LLVM commit date: 2022-01-05 11:01:52 +0000 (ISO 8601 format)
// Date of code generation: 2022-03-25 17:44:20-04:00
//========================================
// The following code is generated.
// Do not edit. Repository of code generator:
// https://github.com/rizinorg/rz-hexagon

#include <rz_types.h>
#include <rz_util.h>
#include <rz_asm.h>
#include <rz_analysis.h>
#include <rz_lib.h>
#include "hexagon.h"
#include "hexagon_insn.h"
#include "hexagon_arch.h"

RZ_API int hexagon_v6_op(RzAnalysis *analysis, RzAnalysisOp *op, ut64 addr, const ut8 *buf, int len, RzAnalysisOpMask mask) {
	if (analysis->pcalign == 0) {
		analysis->pcalign = 0x4;
	}

	HexReversedOpcode rev = { .action = HEXAGON_ANALYSIS, .ana_op = op, .asm_op = NULL };

	hexagon_reverse_opcode(NULL, &rev, buf, addr);

	return op->size;
}

RZ_API char *get_reg_profile(RzAnalysis *analysis) {
	const char *p =

		"=PC	pc\n"
		"=SP	r29\n"
		"=BP	r30\n"
		"=LR	r31\n"
		"=SR	c8\n"
		"=SN	r0\n"
		"=A0	r0\n"
		"=A1	r1\n"
		"=A2	r2\n"
		"=A3	r3\n"
		"=A4	r4\n"
		"=A5	r5\n"
		"=A6	r1:0\n"
		"=A7	r3:2\n"
		"=A8	r5:4\n"
		"=R0	r0\n"
		"=R1	r1\n"
		"=R2	r1:0\n"

		"ctr	c0	.32	1024	0\n"
		"ctr	c1	.32	1056	0\n"
		"ctr	c2	.32	1088	0\n"
		"ctr	c3	.32	1120	0\n"
		"ctr	c4	.32	1152	0\n"
		"ctr	c5	.32	1184	0\n"
		"ctr	c6	.32	1216	0\n"
		"ctr	c7	.32	1248	0\n"
		"ctr	c8	.32	1280	0\n"
		"ctr	c9	.32	1312	0\n"
		"ctr	c10	.32	1344	0\n"
		"ctr	c11	.32	1376	0\n"
		"ctr	c12	.32	1408	0\n"
		"ctr	c13	.32	1440	0\n"
		"ctr	c14	.32	1472	0\n"
		"ctr	c15	.32	1504	0\n"
		"ctr	c16	.32	1536	0\n"
		"ctr	c17	.32	1568	0\n"
		"ctr	c18	.32	1600	0\n"
		"ctr	c19	.32	1632	0\n"
		"ctr	c30	.32	1664	0\n"
		"ctr	c31	.32	1696	0\n"

		"ctr	c1:0	.64	1024	0\n"
		"ctr	c3:2	.64	1088	0\n"
		"ctr	c5:4	.64	1152	0\n"
		"ctr	c7:6	.64	1216	0\n"
		"ctr	c9:8	.64	1280	0\n"
		"ctr	c11:10	.64	1344	0\n"
		"ctr	c13:12	.64	1408	0\n"
		"ctr	c15:14	.64	1472	0\n"
		"ctr	c17:16	.64	1536	0\n"
		"ctr	c19:18	.64	1600	0\n"
		"ctr	c31:30	.64	1664	0\n"

		"gpr	r1:0	.64	0	0\n"
		"gpr	r3:2	.64	64	0\n"
		"gpr	r5:4	.64	128	0\n"
		"gpr	r7:6	.64	192	0\n"
		"gpr	r9:8	.64	256	0\n"
		"gpr	r11:10	.64	320	0\n"
		"gpr	r13:12	.64	384	0\n"
		"gpr	r15:14	.64	448	0\n"
		"gpr	r17:16	.64	512	0\n"
		"gpr	r19:18	.64	576	0\n"
		"gpr	r21:20	.64	640	0\n"
		"gpr	r23:22	.64	704	0\n"
		"gpr	r25:24	.64	768	0\n"
		"gpr	r27:26	.64	832	0\n"
		"gpr	r29:28	.64	896	0\n"
		"gpr	r31:30	.64	960	0\n"

		"gpr	g0	.32	2048	0\n"
		"gpr	g1	.32	2080	0\n"
		"gpr	g2	.32	2112	0\n"
		"gpr	g3	.32	2144	0\n"
		"gpr	g4	.32	2176	0\n"
		"gpr	g5	.32	2208	0\n"
		"gpr	g6	.32	2240	0\n"
		"gpr	g7	.32	2272	0\n"
		"gpr	g8	.32	2304	0\n"
		"gpr	g9	.32	2336	0\n"
		"gpr	g10	.32	2368	0\n"
		"gpr	g11	.32	2400	0\n"
		"gpr	g12	.32	2432	0\n"
		"gpr	g13	.32	2464	0\n"
		"gpr	g14	.32	2496	0\n"
		"gpr	g15	.32	2528	0\n"
		"gpr	g16	.32	2560	0\n"
		"gpr	g17	.32	2592	0\n"
		"gpr	g18	.32	2624	0\n"
		"gpr	g19	.32	2656	0\n"
		"gpr	g20	.32	2688	0\n"
		"gpr	g21	.32	2720	0\n"
		"gpr	g22	.32	2752	0\n"
		"gpr	g23	.32	2784	0\n"
		"gpr	g24	.32	2816	0\n"
		"gpr	g25	.32	2848	0\n"
		"gpr	g26	.32	2880	0\n"
		"gpr	g27	.32	2912	0\n"
		"gpr	g28	.32	2944	0\n"
		"gpr	g29	.32	2976	0\n"
		"gpr	g30	.32	3008	0\n"
		"gpr	g31	.32	3040	0\n"

		"gpr	g1:0	.64	2048	0\n"
		"gpr	g3:2	.64	2112	0\n"
		"gpr	g5:4	.64	2176	0\n"
		"gpr	g7:6	.64	2240	0\n"
		"gpr	g9:8	.64	2304	0\n"
		"gpr	g11:10	.64	2368	0\n"
		"gpr	g13:12	.64	2432	0\n"
		"gpr	g15:14	.64	2496	0\n"
		"gpr	g17:16	.64	2560	0\n"
		"gpr	g19:18	.64	2624	0\n"
		"gpr	g21:20	.64	2688	0\n"
		"gpr	g23:22	.64	2752	0\n"
		"gpr	g25:24	.64	2816	0\n"
		"gpr	g27:26	.64	2880	0\n"
		"gpr	g29:28	.64	2944	0\n"
		"gpr	g31:30	.64	3008	0\n"

		"ctr	q0	.128	4096	0\n"
		"ctr	q1	.128	4224	0\n"
		"ctr	q2	.128	4352	0\n"
		"ctr	q3	.128	4480	0\n"

		"vc	v3:0	.4096	3072	0\n"
		"vc	v7:4	.4096	7168	0\n"
		"vc	v11:8	.4096	11264	0\n"
		"vc	v15:12	.4096	15360	0\n"
		"vc	v19:16	.4096	19456	0\n"
		"vc	v23:20	.4096	23552	0\n"
		"vc	v27:24	.4096	27648	0\n"
		"vc	v31:28	.4096	31744	0\n"

		"vc	v0	.1024	3072	0\n"
		"vc	v1	.1024	4096	0\n"
		"vc	v2	.1024	5120	0\n"
		"vc	v3	.1024	6144	0\n"
		"vc	v4	.1024	7168	0\n"
		"vc	v5	.1024	8192	0\n"
		"vc	v6	.1024	9216	0\n"
		"vc	v7	.1024	10240	0\n"
		"vc	v8	.1024	11264	0\n"
		"vc	v9	.1024	12288	0\n"
		"vc	v10	.1024	13312	0\n"
		"vc	v11	.1024	14336	0\n"
		"vc	v12	.1024	15360	0\n"
		"vc	v13	.1024	16384	0\n"
		"vc	v14	.1024	17408	0\n"
		"vc	v15	.1024	18432	0\n"
		"vc	v16	.1024	19456	0\n"
		"vc	v17	.1024	20480	0\n"
		"vc	v18	.1024	21504	0\n"
		"vc	v19	.1024	22528	0\n"
		"vc	v20	.1024	23552	0\n"
		"vc	v21	.1024	24576	0\n"
		"vc	v22	.1024	25600	0\n"
		"vc	v23	.1024	26624	0\n"
		"vc	v24	.1024	27648	0\n"
		"vc	v25	.1024	28672	0\n"
		"vc	v26	.1024	29696	0\n"
		"vc	v27	.1024	30720	0\n"
		"vc	v28	.1024	31744	0\n"
		"vc	v29	.1024	32768	0\n"
		"vc	v30	.1024	33792	0\n"
		"vc	v31	.1024	34816	0\n"

		"vc	v1:0	.2048	3072	0\n"
		"vc	v3:2	.2048	5120	0\n"
		"vc	v5:4	.2048	7168	0\n"
		"vc	v7:6	.2048	9216	0\n"
		"vc	v9:8	.2048	11264	0\n"
		"vc	v11:10	.2048	13312	0\n"
		"vc	v13:12	.2048	15360	0\n"
		"vc	v15:14	.2048	17408	0\n"
		"vc	v17:16	.2048	19456	0\n"
		"vc	v19:18	.2048	21504	0\n"
		"vc	v21:20	.2048	23552	0\n"
		"vc	v23:22	.2048	25600	0\n"
		"vc	v25:24	.2048	27648	0\n"
		"vc	v27:26	.2048	29696	0\n"
		"vc	v29:28	.2048	31744	0\n"
		"vc	v31:30	.2048	33792	0\n"

		"gpr	r0	.32	0	0\n"
		"gpr	r1	.32	32	0\n"
		"gpr	r2	.32	64	0\n"
		"gpr	r3	.32	96	0\n"
		"gpr	r4	.32	128	0\n"
		"gpr	r5	.32	160	0\n"
		"gpr	r6	.32	192	0\n"
		"gpr	r7	.32	224	0\n"
		"gpr	r8	.32	256	0\n"
		"gpr	r9	.32	288	0\n"
		"gpr	r10	.32	320	0\n"
		"gpr	r11	.32	352	0\n"
		"gpr	r12	.32	384	0\n"
		"gpr	r13	.32	416	0\n"
		"gpr	r14	.32	448	0\n"
		"gpr	r15	.32	480	0\n"
		"gpr	r16	.32	512	0\n"
		"gpr	r17	.32	544	0\n"
		"gpr	r18	.32	576	0\n"
		"gpr	r19	.32	608	0\n"
		"gpr	r20	.32	640	0\n"
		"gpr	r21	.32	672	0\n"
		"gpr	r22	.32	704	0\n"
		"gpr	r23	.32	736	0\n"
		"gpr	r24	.32	768	0\n"
		"gpr	r25	.32	800	0\n"
		"gpr	r26	.32	832	0\n"
		"gpr	r27	.32	864	0\n"
		"gpr	r28	.32	896	0\n"
		"gpr	r29	.32	928	0\n"
		"gpr	r30	.32	960	0\n"
		"gpr	r31	.32	992	0\n"

		"ctr	p0	.8	1152	0\n"
		"ctr	p1	.8	1160	0\n"
		"ctr	p2	.8	1168	0\n"
		"ctr	p3	.8	1176	0\n"

		"sys	s0	.32	4608	0\n"
		"sys	s1	.32	4640	0\n"
		"sys	s2	.32	4672	0\n"
		"sys	s3	.32	4704	0\n"
		"sys	s4	.32	4736	0\n"
		"sys	s5	.32	4768	0\n"
		"sys	s6	.32	4800	0\n"
		"sys	s7	.32	4832	0\n"
		"sys	s8	.32	4864	0\n"
		"sys	s9	.32	4896	0\n"
		"sys	s10	.32	4928	0\n"
		"sys	s11	.32	4960	0\n"
		"sys	s12	.32	4992	0\n"
		"sys	s13	.32	5024	0\n"
		"sys	s14	.32	5056	0\n"
		"sys	s15	.32	5088	0\n"
		"sys	s16	.32	5120	0\n"
		"sys	s17	.32	5152	0\n"
		"sys	s18	.32	5184	0\n"
		"sys	s19	.32	5216	0\n"
		"sys	s20	.32	5248	0\n"
		"sys	s21	.32	5280	0\n"
		"sys	s22	.32	5312	0\n"
		"sys	s23	.32	5344	0\n"
		"sys	s24	.32	5376	0\n"
		"sys	s25	.32	5408	0\n"
		"sys	s26	.32	5440	0\n"
		"sys	s27	.32	5472	0\n"
		"sys	s28	.32	5504	0\n"
		"sys	s29	.32	5536	0\n"
		"sys	s30	.32	5568	0\n"
		"sys	s31	.32	5600	0\n"
		"sys	s32	.32	5632	0\n"
		"sys	s33	.32	5664	0\n"
		"sys	s34	.32	5696	0\n"
		"sys	s35	.32	5728	0\n"
		"sys	s36	.32	5760	0\n"
		"sys	s37	.32	5792	0\n"
		"sys	s38	.32	5824	0\n"
		"sys	s39	.32	5856	0\n"
		"sys	s40	.32	5888	0\n"
		"sys	s41	.32	5920	0\n"
		"sys	s42	.32	5952	0\n"
		"sys	s43	.32	5984	0\n"
		"sys	s44	.32	6016	0\n"
		"sys	s45	.32	6048	0\n"
		"sys	s46	.32	6080	0\n"
		"sys	s47	.32	6112	0\n"
		"sys	s48	.32	6144	0\n"
		"sys	s49	.32	6176	0\n"
		"sys	s50	.32	6208	0\n"
		"sys	s51	.32	6240	0\n"
		"sys	s52	.32	6272	0\n"
		"sys	s53	.32	6304	0\n"
		"sys	s54	.32	6336	0\n"
		"sys	s55	.32	6368	0\n"
		"sys	s56	.32	6400	0\n"
		"sys	s57	.32	6432	0\n"
		"sys	s58	.32	6464	0\n"
		"sys	s59	.32	6496	0\n"
		"sys	s60	.32	6528	0\n"
		"sys	s61	.32	6560	0\n"
		"sys	s62	.32	6592	0\n"
		"sys	s63	.32	6624	0\n"
		"sys	s64	.32	6656	0\n"
		"sys	s65	.32	6688	0\n"
		"sys	s66	.32	6720	0\n"
		"sys	s67	.32	6752	0\n"
		"sys	s68	.32	6784	0\n"
		"sys	s69	.32	6816	0\n"
		"sys	s70	.32	6848	0\n"
		"sys	s71	.32	6880	0\n"
		"sys	s72	.32	6912	0\n"
		"sys	s73	.32	6944	0\n"
		"sys	s74	.32	6976	0\n"
		"sys	s75	.32	7008	0\n"
		"sys	s76	.32	7040	0\n"
		"sys	s77	.32	7072	0\n"
		"sys	s78	.32	7104	0\n"
		"sys	s79	.32	7136	0\n"
		"sys	s80	.32	7168	0\n"

		"sys	s1:0	.64	4608	0\n"
		"sys	s3:2	.64	4672	0\n"
		"sys	s5:4	.64	4736	0\n"
		"sys	s7:6	.64	4800	0\n"
		"sys	s9:8	.64	4864	0\n"
		"sys	s11:10	.64	4928	0\n"
		"sys	s13:12	.64	4992	0\n"
		"sys	s15:14	.64	5056	0\n"
		"sys	s17:16	.64	5120	0\n"
		"sys	s19:18	.64	5184	0\n"
		"sys	s21:20	.64	5248	0\n"
		"sys	s23:22	.64	5312	0\n"
		"sys	s25:24	.64	5376	0\n"
		"sys	s27:26	.64	5440	0\n"
		"sys	s29:28	.64	5504	0\n"
		"sys	s31:30	.64	5568	0\n"
		"sys	s33:32	.64	5632	0\n"
		"sys	s35:34	.64	5696	0\n"
		"sys	s37:36	.64	5760	0\n"
		"sys	s39:38	.64	5824	0\n"
		"sys	s41:40	.64	5888	0\n"
		"sys	s43:42	.64	5952	0\n"
		"sys	s45:44	.64	6016	0\n"
		"sys	s47:46	.64	6080	0\n"
		"sys	s49:48	.64	6144	0\n"
		"sys	s51:50	.64	6208	0\n"
		"sys	s53:52	.64	6272	0\n"
		"sys	s55:54	.64	6336	0\n"
		"sys	s57:56	.64	6400	0\n"
		"sys	s59:58	.64	6464	0\n"
		"sys	s61:60	.64	6528	0\n"
		"sys	s63:62	.64	6592	0\n"
		"sys	s65:64	.64	6656	0\n"
		"sys	s67:66	.64	6720	0\n"
		"sys	s69:68	.64	6784	0\n"
		"sys	s71:70	.64	6848	0\n"
		"sys	s73:72	.64	6912	0\n"
		"sys	s75:74	.64	6976	0\n"
		"sys	s77:76	.64	7040	0\n"
		"sys	s79:78	.64	7104	0\n";
	return strdup(p);
}

RzAnalysisPlugin rz_analysis_plugin_hexagon = {
	.name = "hexagon",
	.desc = "Qualcomm Hexagon (QDSP6) V6",
	.license = "LGPL3",
	.arch = "hexagon",
	.bits = 32,
	.op = hexagon_v6_op,
	.esil = false,
	.get_reg_profile = get_reg_profile,
};

#ifndef RZ_PLUGIN_INCORE
RZ_API RzLibStruct rizin_plugin = {
	.type = RZ_LIB_TYPE_ANALYSIS,
	.data = &rz_analysis_plugin_hexagon_v6,
	.version = RZ_VERSION
};
#endif
